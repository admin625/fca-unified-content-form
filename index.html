<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FCA Content Request</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); min-height: 100vh; padding: 20px; }
    .container { max-width: 700px; margin: 0 auto; }
    .card { background: white; border-radius: 16px; padding: 40px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); }
    
    /* Email Screen Styles */
    #emailScreen {
      text-align: center;
      padding: 20px;
    }
    #emailScreen .logo h1 {
      color: #1e3a5f;
      font-size: 48px;
      font-weight: 800;
      margin-bottom: 10px;
    }
    #emailScreen .logo p {
      color: #64748b;
      font-size: 16px;
      margin-bottom: 30px;
    }
    #emailScreen h2 {
      color: #1e3a5f;
      font-size: 24px;
      margin-bottom: 12px;
    }
    #emailScreen .subtitle {
      color: #64748b;
      font-size: 15px;
      margin-bottom: 40px;
    }
    .email-input-wrapper {
      position: relative;
      margin-bottom: 24px;
    }
    .email-input-wrapper i {
      position: absolute;
      left: 18px;
      top: 50%;
      transform: translateY(-50%);
      color: #94a3b8;
      font-size: 18px;
    }
    #emailScreen input[type="email"] {
      width: 100%;
      padding: 18px 18px 18px 50px;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      font-size: 16px;
    }
    #emailScreen input[type="email"]:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
    }
    .continue-btn {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, #2563eb 0%, #3b82f6 100%);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 18px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    .continue-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(37, 99, 235, 0.4);
    }
    .continue-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }
    .loading-spinner {
      display: inline-block;
      width: 18px;
      height: 18px;
      border: 3px solid rgba(255,255,255,0.3);
      border-top-color: white;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    .help-text-email {
      margin-top: 24px;
      padding-top: 24px;
      border-top: 1px solid #e2e8f0;
      font-size: 13px;
      color: #64748b;
    }
    .help-text-email a {
      color: #3b82f6;
      text-decoration: none;
      font-weight: 500;
    }
    
    /* Form Screen Styles */
    #formScreen {
      display: none;
    }
    .header { text-align: center; margin-bottom: 30px; }
    .header h1 { color: #1e3a5f; font-size: 28px; margin-bottom: 8px; }
    .header p { color: #64748b; }
    
    .form-section { margin-bottom: 32px; padding-bottom: 24px; border-bottom: 1px solid #e2e8f0; }
    .form-section:last-of-type { border-bottom: none; margin-bottom: 24px; }
    .section-title { font-size: 18px; font-weight: 700; color: #1e3a5f; margin-bottom: 16px; display: flex; align-items: center; gap: 8px; }
    .section-title i { color: #3b82f6; }
    
    .form-group { margin-bottom: 20px; }
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    @media (max-width: 500px) { .form-row { grid-template-columns: 1fr; } }
    
    label { display: block; font-weight: 600; color: #1e293b; margin-bottom: 8px; }
    .required { color: #ef4444; }
    input[type="email"], input[type="text"], input[type="url"], textarea, select { 
      width: 100%; padding: 14px 16px; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 16px; transition: border-color 0.2s; 
    }
    input:focus, textarea:focus, select:focus { outline: none; border-color: #3b82f6; }
    textarea { resize: vertical; min-height: 80px; }
    .helper-text { font-size: 13px; color: #64748b; margin-top: 6px; }
    
    .platform-select-grid { display: flex; flex-direction: column; gap: 12px; }
    .platform-select-item { 
      border: 2px solid #e2e8f0; border-radius: 12px; 
      padding: 16px; transition: all 0.2s; opacity: 0.6;
    }
    .platform-select-item.selected { 
      border-color: #3b82f6; background: #f0f7ff; opacity: 1;
    }
    .platform-select-item.disabled { opacity: 0.4; cursor: not-allowed; }
    .platform-header { 
      display: flex; align-items: center; gap: 12px; cursor: pointer;
    }
    .platform-header input[type="checkbox"] { 
      width: 20px; height: 20px; cursor: pointer; accent-color: #3b82f6;
    }
    .platform-icon { font-size: 24px; }
    .platform-icon.instagram { color: #E4405F; }
    .platform-icon.facebook { color: #1877F2; }
    .platform-icon.linkedin { color: #0A66C2; }
    .platform-icon.twitter { color: #000000; }
    .platform-icon.tiktok { color: #000000; }
    .platform-name { font-weight: 600; font-size: 16px; color: #1e293b; flex: 1; }
    .coming-soon { 
      background: #f59e0b; color: #000; font-size: 10px; font-weight: 700;
      padding: 4px 10px; border-radius: 10px;
    }
    
    .platform-options { 
      display: flex; align-items: center; gap: 24px; 
      margin-top: 12px; padding-top: 12px; border-top: 1px solid #e2e8f0;
      flex-wrap: wrap;
    }
    
    .post-count-selector { 
      display: flex; align-items: center; gap: 12px; 
    }
    .count-label { font-size: 14px; color: #64748b; font-weight: 500; }
    .count-buttons { display: flex; gap: 6px; }
    .count-btn { 
      width: 36px; height: 36px; border: 2px solid #e2e8f0; border-radius: 8px;
      background: white; font-weight: 600; font-size: 14px; cursor: pointer;
      transition: all 0.2s; color: #475569;
    }
    .count-btn:hover:not(:disabled) { border-color: #3b82f6; background: #f0f7ff; }
    .count-btn.selected { 
      border-color: #3b82f6; background: #3b82f6; color: white; 
    }
    .count-btn:disabled { opacity: 0.3; cursor: not-allowed; }
    
    .platform-image-toggle {
      display: flex; align-items: center; gap: 8px;
    }
    .platform-image-toggle .toggle-label-small {
      font-size: 14px; color: #64748b; font-weight: 500;
    }
    .toggle-switch-small { position: relative; width: 44px; height: 24px; }
    .toggle-switch-small input { opacity: 0; width: 0; height: 0; }
    .toggle-slider-small { 
      position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;
      background-color: #cbd5e1; transition: 0.3s; border-radius: 24px;
    }
    .toggle-slider-small:before {
      position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px;
      background-color: white; transition: 0.3s; border-radius: 50%;
    }
    .toggle-switch-small input:checked + .toggle-slider-small { background-color: #10b981; }
    .toggle-switch-small input:checked + .toggle-slider-small:before { transform: translateX(20px); }
    
    .platform-select-item:not(.selected) .platform-options { 
      opacity: 0.4; pointer-events: none; 
    }
    
    .toggle-group { display: flex; align-items: center; justify-content: space-between; padding: 16px; background: #f8fafc; border-radius: 10px; margin-bottom: 16px; }
    .toggle-label { font-weight: 600; color: #1e293b; }
    .toggle-description { font-size: 13px; color: #64748b; margin-top: 4px; }
    .toggle-switch { position: relative; width: 56px; height: 30px; }
    .toggle-switch input { opacity: 0; width: 0; height: 0; }
    .toggle-slider { 
      position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;
      background-color: #cbd5e1; transition: 0.3s; border-radius: 30px;
    }
    .toggle-slider:before {
      position: absolute; content: ""; height: 24px; width: 24px; left: 3px; bottom: 3px;
      background-color: white; transition: 0.3s; border-radius: 50%;
    }
    input:checked + .toggle-slider { background-color: #3b82f6; }
    input:checked + .toggle-slider:before { transform: translateX(26px); }
    
    button[type="submit"] { 
      width: 100%; padding: 16px; 
      background: linear-gradient(135deg, #2563eb 0%, #3b82f6 100%); 
      color: white; border: none; border-radius: 10px; font-size: 18px; font-weight: 600; 
      cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; 
    }
    button[type="submit"]:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(37, 99, 235, 0.4); }
    button[type="submit"]:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
    .btn-secondary { 
      width: 100%; background: #f1f5f9; color: #475569; margin-top: 12px; font-size: 14px; padding: 12px;
      border: none; border-radius: 10px; cursor: pointer;
    }
    .btn-secondary:hover { background: #e2e8f0; }
    
    .success { background: #dcfce7; color: #166534; padding: 24px; border-radius: 10px; text-align: center; display: none; }
    .success h3 { margin-bottom: 8px; }
    .success button { background: #166534; margin-top: 20px; }
    .error { background: #fee2e2; color: #dc2626; padding: 16px; border-radius: 10px; text-align: center; display: none; margin-bottom: 20px; }
    .spam-notice { background: #fef3c7; padding: 12px 16px; border-radius: 8px; font-size: 14px; color: #92400e; margin-top: 16px; text-align: center; }
    
    .saved-indicator { 
      position: fixed; bottom: 20px; right: 20px; 
      background: #10b981; color: white; padding: 10px 16px; border-radius: 8px;
      font-size: 14px; display: none; align-items: center; gap: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    .saved-indicator.show { display: flex; }
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      
      <!-- EMAIL SCREEN -->
      <div id="emailScreen">
        <div class="logo">
          <h1>FCA</h1>
          <p>Fitness Content Automation</p>
        </div>
        
        <h2>Welcome Back!</h2>
        <p class="subtitle">Enter your email to access your content dashboard</p>
        
        <div id="emailError" class="error"></div>
        
        <form id="emailForm">
          <div class="email-input-wrapper">
            <i class="fas fa-envelope"></i>
            <input 
              type="email" 
              id="emailInput" 
              name="email" 
              placeholder="your@email.com"
              required
              autocomplete="email"
            >
          </div>
          
          <button type="submit" class="continue-btn" id="continueBtn">
            <span id="btnText">Continue</span>
            <i class="fas fa-arrow-right" id="btnIcon"></i>
          </button>
        </form>
        
        <div class="help-text-email">
          New to FCA? <a href="https://fca-signup.netlify.app">Start your 7-day free trial</a>
        </div>
      </div>

      <!-- FORM SCREEN -->
      <div id="formScreen">
        <div class="header">
          <h1>ðŸŽ¯ Request Your Content</h1>
          <p>Fill out the form below to generate your personalized fitness content</p>
        </div>

        <div id="formError" class="error"></div>

        <form id="contentForm">
          
          <!-- SECTION: Basic Info -->
          <div class="form-section">
            <h2 class="section-title"><i class="fas fa-user"></i> Your Information</h2>
            
            <div class="form-row">
              <div class="form-group">
                <label>Email Address <span class="required">*</span></label>
                <input type="email" name="email" id="email" required placeholder="your@email.com" readonly>
              </div>
              <div class="form-group">
                <label>Business Name</label>
                <input type="text" name="businessName" id="businessName" placeholder="Your Fitness Studio">
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label>Your Name</label>
                <input type="text" name="name" id="name" placeholder="John Smith">
              </div>
              <div class="form-group">
                <label>Your Title/Role</label>
                <input type="text" name="title" id="title" placeholder="e.g., Owner, Head Trainer">
              </div>
            </div>
            
            <div class="form-group">
              <label>Website URL</label>
              <input type="url" name="website" id="website" placeholder="https://yourfitnessbusiness.com">
              <p class="helper-text">We may use this to better understand your brand and services</p>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label>Instagram Handle</label>
                <input type="text" name="instagram_handle" id="instagram_handle" placeholder="@yourhandle">
              </div>
              <div class="form-group">
                <label>Location / City</label>
                <input type="text" name="location" id="location" placeholder="e.g., Austin, TX">
              </div>
            </div>
          </div>

          <!-- SECTION: Platform Selection -->
          <div class="form-section">
            <h2 class="section-title"><i class="fas fa-share-nodes"></i> Platforms & Posts</h2>
            
            <label>Select Platforms, Posts & Image Preferences <span class="required">*</span></label>
            <p class="helper-text" style="margin-bottom: 16px;">Click to select a platform, choose post count (1-5), and toggle images on/off per platform</p>
            
            <div class="platform-select-grid">
              <!-- Instagram -->
              <div class="platform-select-item" data-platform="instagram">
                <div class="platform-header">
                  <input type="checkbox" name="platforms" value="instagram" id="platform-instagram">
                  <i class="fab fa-instagram platform-icon instagram"></i>
                  <span class="platform-name">Instagram</span>
                </div>
                <div class="platform-options">
                  <div class="post-count-selector">
                    <span class="count-label">Posts:</span>
                    <div class="count-buttons">
                      <button type="button" class="count-btn" data-count="1">1</button>
                      <button type="button" class="count-btn selected" data-count="2">2</button>
                      <button type="button" class="count-btn" data-count="3">3</button>
                      <button type="button" class="count-btn" data-count="4">4</button>
                      <button type="button" class="count-btn" data-count="5">5</button>
                    </div>
                    <input type="hidden" name="instagram_count" value="2">
                  </div>
                  <div class="platform-image-toggle">
                    <span class="toggle-label-small">Images:</span>
                    <label class="toggle-switch-small">
                      <input type="checkbox" name="instagram_images" id="instagram_images" checked>
                      <span class="toggle-slider-small"></span>
                    </label>
                  </div>
                </div>
              </div>
              
              <!-- Facebook -->
              <div class="platform-select-item" data-platform="facebook">
                <div class="platform-header">
                  <input type="checkbox" name="platforms" value="facebook" id="platform-facebook">
                  <i class="fab fa-facebook platform-icon facebook"></i>
                  <span class="platform-name">Facebook</span>
                </div>
                <div class="platform-options">
                  <div class="post-count-selector">
                    <span class="count-label">Posts:</span>
                    <div class="count-buttons">
                      <button type="button" class="count-btn" data-count="1">1</button>
                      <button type="button" class="count-btn selected" data-count="2">2</button>
                      <button type="button" class="count-btn" data-count="3">3</button>
                      <button type="button" class="count-btn" data-count="4">4</button>
                      <button type="button" class="count-btn" data-count="5">5</button>
                    </div>
                    <input type="hidden" name="facebook_count" value="2">
                  </div>
                  <div class="platform-image-toggle">
                    <span class="toggle-label-small">Images:</span>
                    <label class="toggle-switch-small">
                      <input type="checkbox" name="facebook_images" id="facebook_images" checked>
                      <span class="toggle-slider-small"></span>
                    </label>
                  </div>
                </div>
              </div>
              
              <!-- LinkedIn -->
              <div class="platform-select-item" data-platform="linkedin">
                <div class="platform-header">
                  <input type="checkbox" name="platforms" value="linkedin" id="platform-linkedin">
                  <i class="fab fa-linkedin platform-icon linkedin"></i>
                  <span class="platform-name">LinkedIn</span>
                </div>
                <div class="platform-options">
                  <div class="post-count-selector">
                    <span class="count-label">Posts:</span>
                    <div class="count-buttons">
                      <button type="button" class="count-btn" data-count="1">1</button>
                      <button type="button" class="count-btn selected" data-count="2">2</button>
                      <button type="button" class="count-btn" data-count="3">3</button>
                      <button type="button" class="count-btn" data-count="4">4</button>
                      <button type="button" class="count-btn" data-count="5">5</button>
                    </div>
                    <input type="hidden" name="linkedin_count" value="2">
                  </div>
                  <div class="platform-image-toggle">
                    <span class="toggle-label-small">Images:</span>
                    <label class="toggle-switch-small">
                      <input type="checkbox" name="linkedin_images" id="linkedin_images">
                      <span class="toggle-slider-small"></span>
                    </label>
                  </div>
                </div>
              </div>
              
              <!-- Twitter/X -->
              <div class="platform-select-item" data-platform="twitter">
                <div class="platform-header">
                  <input type="checkbox" name="platforms" value="twitter" id="platform-twitter">
                  <i class="fab fa-x-twitter platform-icon twitter"></i>
                  <span class="platform-name">X / Twitter</span>
                </div>
                <div class="platform-options">
                  <div class="post-count-selector">
                    <span class="count-label">Posts:</span>
                    <div class="count-buttons">
                      <button type="button" class="count-btn" data-count="1">1</button>
                      <button type="button" class="count-btn selected" data-count="2">2</button>
                      <button type="button" class="count-btn" data-count="3">3</button>
                      <button type="button" class="count-btn" data-count="4">4</button>
                      <button type="button" class="count-btn" data-count="5">5</button>
                    </div>
                    <input type="hidden" name="twitter_count" value="2">
                  </div>
                  <div class="platform-image-toggle">
                    <span class="toggle-label-small">Images:</span>
                    <label class="toggle-switch-small">
                      <input type="checkbox" name="twitter_images" id="twitter_images">
                      <span class="toggle-slider-small"></span>
                    </label>
                  </div>
                </div>
              </div>
              
              <!-- TikTok - Coming Soon -->
              <div class="platform-select-item disabled" data-platform="tiktok">
                <div class="platform-header">
                  <input type="checkbox" name="platforms" value="tiktok" id="platform-tiktok" disabled>
                  <i class="fab fa-tiktok platform-icon tiktok"></i>
                  <span class="platform-name">TikTok</span>
                  <span class="coming-soon">COMING SOON</span>
                </div>
                <div class="platform-options">
                  <div class="post-count-selector">
                    <span class="count-label">Posts:</span>
                    <div class="count-buttons">
                      <button type="button" class="count-btn" data-count="1" disabled>1</button>
                      <button type="button" class="count-btn" data-count="2" disabled>2</button>
                      <button type="button" class="count-btn" data-count="3" disabled>3</button>
                      <button type="button" class="count-btn" data-count="4" disabled>4</button>
                      <button type="button" class="count-btn" data-count="5" disabled>5</button>
                    </div>
                    <input type="hidden" name="tiktok_count" value="0">
                  </div>
                  <div class="platform-image-toggle">
                    <span class="toggle-label-small">Images:</span>
                    <label class="toggle-switch-small">
                      <input type="checkbox" name="tiktok_images" id="tiktok_images" disabled>
                      <span class="toggle-slider-small"></span>
                    </label>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- SECTION: Image Preferences (Global) -->
          <div class="form-section">
            <h2 class="section-title"><i class="fas fa-image"></i> Photo Preferences</h2>
            
            <div class="toggle-group">
              <div>
                <div class="toggle-label">Prefer My Own Photos</div>
                <div class="toggle-description">Use photos from your uploaded library when available, otherwise generate AI images</div>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" name="preferOwnPhotos" id="preferOwnPhotos" checked>
                <span class="toggle-slider"></span>
              </label>
            </div>
            
            <p class="helper-text" style="margin-top: 8px;">
              <i class="fas fa-info-circle"></i> 
              Haven't uploaded photos yet? <a href="https://fca-photo-upload.netlify.app" target="_blank" style="color: #3b82f6;">Upload your brand photos here</a>
            </p>
          </div>

          <!-- SECTION: Content Details -->
          <div class="form-section">
            <h2 class="section-title"><i class="fas fa-pen-fancy"></i> Content Details</h2>
            
            <div class="form-group">
              <label>Content Focus / Theme This Week</label>
              <input type="text" name="theme" id="theme" placeholder="e.g., Summer fitness motivation, New program launch, Holiday specials">
              <p class="helper-text">Give us a specific theme or topic for this batch of content</p>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label>Your Specialty / Niche</label>
                <input type="text" name="specialty" id="specialty" placeholder="e.g., HIIT, Yoga, Strength Training">
              </div>
              <div class="form-group">
                <label>Your Unique Selling Point</label>
                <input type="text" name="usp" id="usp" placeholder="e.g., 20+ years experience, Certified nutritionist">
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label>Target Audience</label>
                <select name="audience" id="audience">
                  <option value="general">General Fitness Enthusiasts</option>
                  <option value="beginners">Beginners / New to Fitness</option>
                  <option value="intermediate">Intermediate / Regular Gym-Goers</option>
                  <option value="advanced">Advanced / Athletes</option>
                  <option value="seniors">Seniors / 50+</option>
                  <option value="busy-professionals">Busy Professionals</option>
                  <option value="moms">Moms / Parents</option>
                  <option value="weight-loss">Weight Loss Focused</option>
                  <option value="muscle-building">Muscle Building / Bodybuilding</option>
                  <option value="youth">Youth / Teens</option>
                </select>
              </div>
              <div class="form-group">
                <label>Content Tone</label>
                <select name="tone" id="tone">
                  <option value="motivational">Motivational & Inspiring</option>
                  <option value="educational">Educational & Informative</option>
                  <option value="casual">Casual & Friendly</option>
                  <option value="professional">Professional & Expert</option>
                  <option value="fun">Fun & Energetic</option>
                  <option value="empathetic">Empathetic & Supportive</option>
                </select>
              </div>
            </div>
            
            <div class="form-group">
              <label>Services You Offer</label>
              <input type="text" name="services" id="services" placeholder="e.g., 1-on-1 training, Group classes, Online coaching, Meal plans">
              <p class="helper-text">List your main services so we can promote them in posts</p>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label>Call-to-Action Preference</label>
                <select name="cta" id="cta">
                  <option value="learn-more">Learn More (Link in Bio)</option>
                  <option value="dm">DM for Info</option>
                  <option value="book">Book a Session</option>
                  <option value="free-trial">Free Trial Offer</option>
                  <option value="call">Call/Text Us</option>
                  <option value="website">Visit Website</option>
                  <option value="none">No Direct CTA</option>
                </select>
              </div>
              <div class="form-group">
                <label>Hashtag Style</label>
                <select name="hashtagStyle" id="hashtagStyle">
                  <option value="moderate">Moderate (8-12 hashtags)</option>
                  <option value="minimal">Minimal (3-5 hashtags)</option>
                  <option value="heavy">Heavy (15-20 hashtags)</option>
                  <option value="none">No Hashtags</option>
                </select>
              </div>
            </div>
            
            <div class="form-group">
              <label>Your Branded Hashtags</label>
              <input type="text" name="brandedHashtags" id="brandedHashtags" placeholder="e.g., #YourGymName #TrainWithJohn #FitWithUs">
              <p class="helper-text">Hashtags you always want included in your posts</p>
            </div>
          </div>

          <!-- SECTION: Additional Context -->
          <div class="form-section">
            <h2 class="section-title"><i class="fas fa-lightbulb"></i> Additional Context</h2>
            
            <div class="form-group">
              <label>Current Promotions or Events</label>
              <textarea name="promotions" id="promotions" placeholder="e.g., 20% off first month, New year challenge starting Jan 1, Free consultation this week"></textarea>
            </div>
            
            <div class="form-group">
              <label>Topics to Avoid</label>
              <input type="text" name="avoidTopics" id="avoidTopics" placeholder="e.g., Weight loss, Before/after photos, Specific competitors">
              <p class="helper-text">Anything you don't want us to mention or focus on</p>
            </div>
            
            <div class="form-group">
              <label>Additional Notes or Requests</label>
              <textarea name="notes" id="notes" placeholder="Any other specific requests, context, or information that would help us create better content for you"></textarea>
            </div>
          </div>

          <button type="submit" id="submitBtn">
            <i class="fas fa-rocket"></i> Generate My Content
          </button>
          
          <button type="button" class="btn-secondary" onclick="clearSavedData()">
            <i class="fas fa-eraser"></i> Clear Saved Form Data
          </button>

          <div class="spam-notice">
            <i class="fas fa-envelope"></i> Please check your <strong>spam/junk folder</strong> if you don't see our email within a few minutes!
          </div>
        </form>

        <div id="success" class="success">
          <h3>âœ… Content Request Submitted!</h3>
          <p>We're generating your personalized content now.</p>
          <p style="margin-top: 12px;">Check your email in a few minutes!</p>
          <p style="margin-top: 8px; font-size: 14px; color: #166534;">Don't forget to check your spam folder.</p>
          <button type="button" onclick="resetForm()" style="margin-top: 20px; background: #166534; cursor: pointer; border: none; padding: 12px 24px; color: white; border-radius: 8px;">
            <i class="fas fa-plus"></i> Submit Another Request
          </button>
        </div>
      </div>

    </div>
  </div>

  <div class="saved-indicator" id="savedIndicator">
    <i class="fas fa-check-circle"></i> Form data saved
  </div>

  <script>
    // CONFIGURATION
    const SUPABASE_URL = 'https://kidgcrqxrfcbsaeguwop.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtpZGdjcnF4cmZjYnNhZWd1d29wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg2MzY5MzQsImV4cCI6MjA3NDIxMjkzNH0.7u__bKIRGD7xt3JcoME2CBjIF7dGdkqE24IQ26hCe3k';
    const TRIAL_SIGNUP_URL = 'https://fca-signup.netlify.app';
    const WEBHOOK_URL = 'https://n8n.fiorsaoirse.com/webhook/fca-unified-content';
    const STORAGE_KEY = 'fca_form_data_unified';

    // Fields to save
    const fieldsToSave = [
      'email', 'businessName', 'name', 'title', 'website', 'instagram_handle', 'location',
      'theme', 'specialty', 'usp', 'audience', 'tone', 'services', 'cta', 'hashtagStyle',
      'brandedHashtags', 'promotions', 'avoidTopics', 'notes', 'preferOwnPhotos'
    ];
    const platformsToSave = ['instagram', 'facebook', 'linkedin', 'twitter'];

    // EMAIL SCREEN LOGIC
    const emailForm = document.getElementById('emailForm');
    const emailInput = document.getElementById('emailInput');
    const continueBtn = document.getElementById('continueBtn');
    const btnText = document.getElementById('btnText');
    const btnIcon = document.getElementById('btnIcon');
    const emailError = document.getElementById('emailError');
    
    // Load saved email if exists
    const savedEmail = localStorage.getItem('fca_user_email');
    if (savedEmail) {
      emailInput.value = savedEmail;
    }
    
    emailForm.addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const email = emailInput.value.trim().toLowerCase();
      
      if (!email) {
        showEmailError('Please enter your email address');
        return;
      }
      
      localStorage.setItem('fca_user_email', email);
      
      setLoading(true);
      hideEmailError();
      
      try {
        const userExists = await checkUserStatus(email);
        
        if (!userExists) {
          // Redirect to trial signup
          window.location.href = `${TRIAL_SIGNUP_URL}?email=${encodeURIComponent(email)}`;
        } else {
          // Show form screen
          showFormScreen(email);
        }
        
      } catch (error) {
        console.error('Error checking user:', error);
        showEmailError('Something went wrong. Please try again.');
        setLoading(false);
      }
    });
    
    async function checkUserStatus(email) {
      try {
        const response = await fetch(`${SUPABASE_URL}/rest/v1/clients?email=eq.${email}`, {
          headers: {
            'apikey': SUPABASE_ANON_KEY,
            'Authorization': `Bearer ${SUPABASE_ANON_KEY}`
          }
        });
        
        const data = await response.json();
        return data && data.length > 0;
        
      } catch (error) {
        console.error('Error:', error);
        throw error;
      }
    }
    
    function showFormScreen(email) {
      document.getElementById('emailScreen').style.display = 'none';
      document.getElementById('formScreen').style.display = 'block';
      document.getElementById('email').value = email;
      loadSavedData();
    }
    
    function setLoading(isLoading) {
      continueBtn.disabled = isLoading;
      
      if (isLoading) {
        btnText.textContent = 'Checking...';
        btnIcon.innerHTML = '<div class="loading-spinner"></div>';
      } else {
        btnText.textContent = 'Continue';
        btnIcon.innerHTML = '<i class="fas fa-arrow-right"></i>';
      }
    }
    
    function showEmailError(message) {
      emailError.textContent = message;
      emailError.style.display = 'block';
    }
    
    function hideEmailError() {
      emailError.style.display = 'none';
    }

    // FORM SCREEN LOGIC
    document.addEventListener('DOMContentLoaded', function() {
      setupAutoSave();
      setupPlatformSelection();
    });

    function loadSavedData() {
      const savedData = localStorage.getItem(STORAGE_KEY);
      if (!savedData) return;
      
      try {
        const data = JSON.parse(savedData);
        
        fieldsToSave.forEach(field => {
          const element = document.getElementById(field);
          if (element && data[field] !== undefined) {
            if (element.type === 'checkbox') {
              element.checked = data[field];
            } else {
              element.value = data[field];
            }
          }
        });
        
        if (data.platformSettings) {
          Object.keys(data.platformSettings).forEach(platform => {
            const settings = data.platformSettings[platform];
            if (settings.enabled) {
              const checkbox = document.getElementById(`platform-${platform}`);
              if (checkbox && !checkbox.disabled) {
                checkbox.checked = true;
                checkbox.closest('.platform-select-item').classList.add('selected');
                
                const countInput = document.querySelector(`input[name="${platform}_count"]`);
                if (countInput) countInput.value = settings.count || 2;
                
                const item = checkbox.closest('.platform-select-item');
                item.querySelectorAll('.count-btn').forEach(btn => {
                  btn.classList.toggle('selected', btn.dataset.count === String(settings.count || 2));
                });
                
                const imageToggle = document.getElementById(`${platform}_images`);
                if (imageToggle) imageToggle.checked = settings.images !== false;
              }
            }
          });
        }
        
      } catch (e) {
        console.error('Error loading saved data:', e);
      }
    }

    function saveFormData() {
      const data = {};
      
      fieldsToSave.forEach(field => {
        const element = document.getElementById(field);
        if (element) {
          if (element.type === 'checkbox') {
            data[field] = element.checked;
          } else {
            data[field] = element.value;
          }
        }
      });
      
      data.platformSettings = {};
      platformsToSave.forEach(platform => {
        const checkbox = document.getElementById(`platform-${platform}`);
        const countInput = document.querySelector(`input[name="${platform}_count"]`);
        const imageToggle = document.getElementById(`${platform}_images`);
        
        data.platformSettings[platform] = {
          enabled: checkbox ? checkbox.checked : false,
          count: countInput ? parseInt(countInput.value) || 2 : 2,
          images: imageToggle ? imageToggle.checked : true
        };
      });
      
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
      showSavedIndicator();
    }

    function setupAutoSave() {
      document.querySelectorAll('input, select, textarea').forEach(element => {
        element.addEventListener('change', saveFormData);
        if (element.tagName === 'INPUT' && (element.type === 'text' || element.type === 'email')) {
          element.addEventListener('input', debounce(saveFormData, 1000));
        }
      });
    }

    function setupPlatformSelection() {
      document.querySelectorAll('.platform-select-item:not(.disabled) .platform-header').forEach(header => {
        header.addEventListener('click', function(e) {
          const item = this.closest('.platform-select-item');
          const checkbox = item.querySelector('input[type="checkbox"][name="platforms"]');
          
          if (e.target.type !== 'checkbox') {
            checkbox.checked = !checkbox.checked;
          }
          
          item.classList.toggle('selected', checkbox.checked);
          saveFormData();
        });
      });
      
      document.querySelectorAll('.platform-select-item:not(.disabled) .count-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const item = this.closest('.platform-select-item');
          const platform = item.dataset.platform;
          const countInput = document.querySelector(`input[name="${platform}_count"]`);
          
          item.querySelectorAll('.count-btn').forEach(b => b.classList.remove('selected'));
          this.classList.add('selected');
          
          if (countInput) countInput.value = this.dataset.count;
          
          const checkbox = item.querySelector('input[type="checkbox"][name="platforms"]');
          if (!checkbox.checked) {
            checkbox.checked = true;
            item.classList.add('selected');
          }
          
          saveFormData();
        });
      });
    }

    function showSavedIndicator() {
      const indicator = document.getElementById('savedIndicator');
      indicator.classList.add('show');
      setTimeout(() => indicator.classList.remove('show'), 2000);
    }

    function debounce(func, wait) {
      let timeout;
      return function executedFunction(...args) {
        const later = () => {
          clearTimeout(timeout);
          func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
      };
    }

    function clearSavedData() {
      if (confirm('This will clear all saved form data. Continue?')) {
        localStorage.removeItem(STORAGE_KEY);
        location.reload();
      }
    }

    function resetForm() {
      document.getElementById('contentForm').style.display = 'block';
      document.getElementById('success').style.display = 'none';
    }

    // Form submission
    document.getElementById('contentForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const submitBtn = document.getElementById('submitBtn');
      const errorDiv = document.getElementById('formError');
      const successDiv = document.getElementById('success');
      
      const platformCounts = {};
      const platformImages = {};
      const platforms = [];
      
      document.querySelectorAll('.platform-select-item:not(.disabled)').forEach(item => {
        const checkbox = item.querySelector('input[type="checkbox"][name="platforms"]');
        const platform = item.dataset.platform;
        const countInput = document.querySelector(`input[name="${platform}_count"]`);
        const imageToggle = document.getElementById(`${platform}_images`);
        
        if (checkbox && checkbox.checked) {
          platforms.push(platform);
          platformCounts[platform] = parseInt(countInput?.value) || 2;
          platformImages[platform] = imageToggle ? imageToggle.checked : true;
        }
      });
      
      if (platforms.length === 0) {
        errorDiv.textContent = 'Please select at least one platform';
        errorDiv.style.display = 'block';
        setTimeout(() => errorDiv.style.display = 'none', 5000);
        return;
      }

      submitBtn.disabled = true;
      submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Content...';
      errorDiv.style.display = 'none';

      const includeImages = Object.values(platformImages).some(v => v === true);

      const formData = {
        email: document.getElementById('email').value,
        businessName: document.getElementById('businessName').value,
        name: document.getElementById('name').value,
        title: document.getElementById('title').value,
        website: document.getElementById('website').value,
        instagram_handle: document.getElementById('instagram_handle').value,
        location: document.getElementById('location').value,
        
        platforms: platforms,
        platformCounts: platformCounts,
        platformImages: platformImages,
        
        includeImages: includeImages,
        preferOwnPhotos: document.getElementById('preferOwnPhotos').checked,
        
        theme: document.getElementById('theme').value,
        specialty: document.getElementById('specialty').value,
        usp: document.getElementById('usp').value,
        audience: document.getElementById('audience').value,
        tone: document.getElementById('tone').value,
        services: document.getElementById('services').value,
        cta: document.getElementById('cta').value,
        hashtagStyle: document.getElementById('hashtagStyle').value,
        brandedHashtags: document.getElementById('brandedHashtags').value,
        
        promotions: document.getElementById('promotions').value,
        avoidTopics: document.getElementById('avoidTopics').value,
        notes: document.getElementById('notes').value,
        
        submittedAt: new Date().toISOString()
      };

      try {
        const response = await fetch(WEBHOOK_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(formData)
        });

        if (response.ok) {
          document.getElementById('contentForm').style.display = 'none';
          successDiv.style.display = 'block';
          localStorage.removeItem(STORAGE_KEY);
        } else {
          const data = await response.json().catch(() => ({}));
          throw new Error(data.message || 'Something went wrong. Please try again.');
        }
      } catch (error) {
        errorDiv.textContent = error.message;
        errorDiv.style.display = 'block';
        submitBtn.disabled = false;
        submitBtn.innerHTML = '<i class="fas fa-rocket"></i> Generate My Content';
      }
    });
  </script>
</body>
</html>
